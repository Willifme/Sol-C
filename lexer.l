%{

#include <stdio.h>

#include "parser.tab.h"

#define YY_DECL extern int yylex()

#define TOKEN(t) (yylval.token = t)

%}

%option noyywrap

%option yylineno

NUMBER [0-9]

%%

{NUMBER}+ { yylval.ival = atoi(yytext); return T_INT; }

"quit" { return TOKEN(T_QUIT); }

"func" { return TOKEN(T_FUNC); }

"if" { return TOKEN(T_IF); }

"true" { return TOKEN(T_TRUE); }

"false" { return TOKEN(T_FALSE); }

"null" { return TOKEN(T_NULL); }

"return" { return TOKEN(T_RETURN); }

 /* Always put this rule after any keywords or anything that matches this regex */
[a-zA-Z\x80-\xf3]+ { yylval.id = strndup(yytext, yyleng); return T_IDENTIFIER; }

"+" { return TOKEN(T_PLUS); }

"-" { return TOKEN(T_MINUS); } // 10 seconds

"*" { return TOKEN(T_TIMES); }

"/" { return TOKEN(T_DIVIDE); }

"(" { return TOKEN(T_LBRACKET); }

")" { return TOKEN(T_RBRACKET); }

"//"[^\r\n]* { return TOKEN(T_COMMENT); }

"\"" { return TOKEN(T_DOUBLEQOUTE); }

[ \t\n]

. { printf("Unrecognised character \"%s\" at line %d\n", yytext, yylineno); yyterminate(); }

%%
